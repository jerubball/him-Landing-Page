<!DOCTYPE html>
<html onclick="toggleFullscreen()">
<head>
    <meta charset="utf-8">
    <title id="title">him-nyit: time</title>
    <style>
        @import url('https://fonts.googleapis.com/css?family=Orbitron:700');
        body.main {
            background-color: #000000;
        }
        div.box {
            width: 95%;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            vertical-align: middle;
        }
        p.text {
            color: #00FF00;
            font-family: 'Orbitron', sans-serif;
            font-size: 5vw;
            font-weight: bold;
            line-height: 1;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body class="main" id="main" onload="init()">
    <script type='text/javascript'>
        //const format = { localeMatcher: 'best fit', formatMatcher: 'best fit', timeZone: 'UTC', };
        //const format = { era: 'short', year: 'numeric', month: 'short', day: '2-digit', weekday: 'short', hour12: 'false', hourCycle: 'h23', hour: '2-digit', minute: '2-digit', second: '2-digit', timeZoneName: 'short' };
        const format_date = { era: 'short', year: 'numeric', month: 'short', day: '2-digit', weekday: 'short' };
        const format_time = { hour: '2-digit', minute: '2-digit', second: '2-digit', timeZoneName: 'short' };
        const parameter = new URL(window.location.href).searchParams;
        
        const convertTime = function(input) {
            if (input == null || input == '') {
                return 855814500000;
            } else if (!isNaN(input)) {
                return parseInt(input) * 1000;
            } else {
                var date = new Date(input)
                if (!isNaN(date)) {
                    return date.getTime();
                } else {
                    return 855814500000;
                }
            }
        }
        
        const convertUnit = function(input) {
            if (input == null || input == '') {
                return 3600000;
            } else if (!isNaN(input)) {
                return parseInt(input);
            } else if (input == 'minute' || input == 'min') {
                return 60000;
            } else if (input == 'second' || input == 'sec') {
                return 1000;
            } else if (input == 'day') {
                return 86400000;
            } else if (input == 'month' || input == 'mo') {
                return 2629742400;
            } else if (input == 'year' || input == 'yr') {
                return 31556908800;
            } else {
                return 3600000;
            }
        }
        
        const mode = parameter.get('mode') == null ? "" : parameter.get('mode');
        const space = parameter.get('space') == null ? "" : parameter.get('space');
        const line = parameter.get('line') == null ? "<br>" : parameter.get('line');
        const timestamp = convertTime(parameter.get('time'));
        const timefactor = convertUnit(parameter.get('unit'));
        const locale = 'en-US';
        const timelapse = 876543.21 * 3600000;
        
        const numberFormat = function(number, digit) {
            var str = number.toString();
            while (str.length < digit) {
                str = "0" + str;
            }
            return str;
        }
        
        const numberFormatDecimal = function(number, digit) {
            var str = number.toString();
            var dot = str.indexOf('.') + 1;
            if (dot == 0) {
                str += '.';
                dot = str.length;
            }
            for (var pos = str.length - dot; pos < digit; pos++) {
                str += '0';
            }
            return str;
        }
        
        const numberDigit = function(number, digit) {
            var divisor = Math.pow(10, digit);
            return Math.round(number * divisor) / divisor;
        }
        
        const update = function() {
            var text = "";
            var now = new Date();
            
            if (mode == 'unix') {
                text = Math.round(now.getTime() / 1000);
            } else if (mode == 'countdown') {
                text = numberFormatDecimal(numberDigit((timelapse + timestamp - now.getTime()) / timefactor, 4), 4);
            } else if (mode == 'countup') {
                text = numberFormatDecimal(numberDigit((now.getTime() - timestamp) / timefactor, 4), 4);
            } else if (mode == 'none') {
                text = now.toLocaleDateString() + line + now.toLocaleTimeString();
            } else if (mode == 'plain') {
                text = now.toLocaleDateString(locale, format_date).toUpperCase() + line + now.toLocaleTimeString(locale, format_time).toUpperCase();
            } else {
                var item1 = now.getFullYear() + space + now.toLocaleDateString(locale, {month: 'short'}).toUpperCase() + space + now.toLocaleDateString(locale, {day: '2-digit'}) + space + now.toLocaleDateString(locale, {weekday: 'short'}).toUpperCase() + space;
                var timezone = now.toLocaleTimeString(locale, {timeZoneName: 'short'});
                timezone = timezone.substring(timezone.length - 3).toUpperCase();
                var item2 = space + numberFormat(now.getHours(), 2) + space + numberFormat(now.getMinutes(), 2) + space + timezone + space + numberFormat(now.getSeconds(), 2);
                text = item1 + item2;
                //var item = now.toLocaleDateString(locale, format).toUpperCase();
                //text = item.substring(13,17) + space + item.substring(5,8) + space + item.substring(9,11) + space + item.substring(0,3) + space + item.substring(19,21) + space + item.substring(22,24) + space + item.substring(28,31) + space + item.substring(25,27);
            }
            
            document.getElementById("text").innerHTML = text;
        }
        
        const init = function() {
            var timer = setInterval(update, 250);
            
            var font = "5vw";
            
            if (mode == 'unix') {
                font = "9vw";
            } else if (mode == 'countdown' || mode == 'countup') {
                if (timefactor > 3000000) {
                    font = "9vw";
                } else if (timefactor > 50000) {
                    font = "8vw";
                } else {
                    font = "7vw";
                }
            } else if (mode == 'none') {
                font = "7vw";
            } else if (mode == 'plain') {
                font = "7vw";
            } else {
                font = "5vw";
            }
            
            document.getElementById("text").style.fontSize = font;
        }
        
        const toggleFullscreen = function() {
            if (document.fullscreen || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
            else {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                } else if (document.documentElement.mozRequestFullScreen) {
                    document.documentElement.mozRequestFullScreen();
                } else if (document.documentElement.webkitRequestFullscreen) {
                    document.documentElement.webkitRequestFullscreen();
                } else if (document.documentElement.msRequestFullscreen) {
                    document.documentElement.msRequestFullscreen();
                }
            }
        }
    </script>
    <div class="box" id="box">
        <p class="text" id="text"></p>
    </div>
</body>
